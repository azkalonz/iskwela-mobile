(this.webpackJsonpIskwela=this.webpackJsonpIskwela||[]).push([[1],{110:function(e,t,n){},112:function(e,t,n){},113:function(e,t,n){},114:function(e,t,n){},115:function(e,t,n){"use strict";n.r(t);var s=n(0),c=n.n(s),r=n(29),o=n.n(r),i=n(2),a=n(57),l=(n(80),n(81),n(82),n(83),n(84),n(85),n(86),n(87),n(88),n(89),n(16)),u=n(12),j=(n(91),n(5)),d=n.n(j),f=n(13),b=n(20),h=n(14),O={headerTitle:"",setHeaderTitle:Object(l.b)((function(e,t){e.headerTitle=t}))},p=n(59),m=n.n(p).a.create({baseURL:"https://dev-middleware.iskwela.net/api/"}),v={isLoggedIn:!1,logout:Object(l.b)((function(e){e.isLoggedIn=!1,e.accessToken=""})),login:Object(l.f)(function(){var e=Object(f.a)(d.a.mark((function e(t,n){var s,c,r,o,i,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.username,c=n.password,r=n.success,o=n.fail,e.prev=1,e.next=4,m.post("login?username=".concat(s,"&password=").concat(c));case 4:return i=e.sent,e.next=7,t.verifyToken({authData:{type:i.data.token_type,token:i.data.access_token}});case 7:e.sent&&r&&r(),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),(a=e.t0).response&&o&&o(a);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,n){return e.apply(this,arguments)}}()),verifyToken:Object(l.f)(function(){var e=Object(f.a)(d.a.mark((function e(t,n){var s,c,r,o,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.authData,c=n.success,r=n.fail,e.prev=1,e.next=4,m.get("user?include=preferences",{headers:{Authorization:"".concat(s.type," ").concat(s.token)}});case 4:if(200!==(o=e.sent).status){e.next=10;break}return t.setInfo(o.data),t.setAccessToken(s),c&&c(),e.abrupt("return",!0);case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),i=e.t0,r&&r(i);case 16:return e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,n){return e.apply(this,arguments)}}()),setAccessToken:Object(l.b)((function(e,t){var n=t.token,s=t.type;e.accessToken=n,e.tokenType=s})),setInfo:Object(l.b)((function(e,t){e.info=t,e.isLoggedIn=!0})),setIsLoggedIn:Object(l.b)((function(e,t){e.isLoggedIn=t})),getItem:function(e){return e},removeItem:function(e){},setItem:function(e,t){}},x={classes:[],currentClass:null,removeClasses:Object(l.b)((function(e){e.classes=[]})),setClasses:Object(l.b)((function(e,t){e.classes=t})),setCurrentClass:Object(l.b)((function(e,t){e.currentClass=t})),getClasses:Object(l.f)(function(){var e=Object(f.a)(d.a.mark((function e(t,n){var s,c,r,o,i,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.success,c=n.fail,t.removeClasses(),e.prev=2,r=_.getState().userStorage.accessToken,e.next=6,m.get("student/classes",{headers:{Authorization:"Bearer ".concat(r)}});case 6:200===(o=e.sent).status&&(i=o.data,t.setClasses(i.classes),s&&s(i)),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),a=e.t0,c&&c(a);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n){return e.apply(this,arguments)}}())},g=Object(l.c)({nonPersistent:O,userStorage:Object(l.e)(v,{storage:"localStorage"}),classes:x},{version:1}),y=Object(l.d)(),k=y.useStoreActions,w=(y.useStoreDispatch,y.useStoreState),_=g,C=(n(56),n(110),n(1)),S=function(){var e=Object(u.d)(),t=w((function(e){return e.nonPersistent})).headerTitle,n=w((function(e){return e.classes})).currentClass,c=Object(s.useRef)(document.createElement("ion-menu"));return Object(C.jsxs)(i.s,{side:"start",menuId:"first",contentId:"router-outlet",id:"class-menu",ref:c,children:[Object(C.jsxs)(i.l,{children:[Object(C.jsxs)(i.C,{children:[Object(C.jsx)(i.c,{onClick:function(){e.replace("/")},color:"transparent",slot:"start",children:Object(C.jsx)("div",{className:"icon-classes",slot:"end",style:{fontSize:20}})}),Object(C.jsx)(i.A,{slot:"start",className:"class-name",children:t}),Object(C.jsx)(i.c,{onClick:function(){c.current.close()},color:"transparent",slot:"end",children:Object(C.jsx)("div",{className:"icon-menu-close",slot:"end",style:{fontSize:20}})})]}),Object(C.jsx)(i.n,{className:"class-cover",src:(null===n||void 0===n?void 0:n.bg_image)||"/class/default.svg"}),Object(C.jsxs)(i.z,{className:"class-schedule",children:[Object(C.jsx)(i.j,{children:Object(C.jsx)(i.A,{children:null===n||void 0===n?void 0:n.date_from})}),Object(C.jsx)(i.j,{children:Object(C.jsx)(i.A,{children:(null===n||void 0===n?void 0:n.time_from)+" "+(null===n||void 0===n?void 0:n.time_to)})})]})]}),Object(C.jsx)(i.k,{})]})},N=function(){var e=w((function(e){return e.nonPersistent})).headerTitle,t=Object(u.d)(),n=Object(s.useRef)(document.createElement("ion-menu")),c=Object(u.e)();return Object(C.jsxs)(i.s,{side:"start",menuId:"first",contentId:"router-outlet",ref:n,children:[Object(C.jsx)(i.l,{className:"no-shadow",children:Object(C.jsxs)(i.C,{children:[Object(C.jsx)("img",{className:"logo",src:"/logo/logo-full-colored.svg",width:"120",alt:"iSkwela"}),Object(C.jsx)(i.c,{onClick:function(){n.current.close()},color:"transparent",slot:"end",children:Object(C.jsx)(i.m,{icon:h.h,slot:"end",size:"large"})})]})}),Object(C.jsx)(i.k,{children:Object(C.jsx)(i.r,{lines:"none",children:Object(C.jsxs)(i.p,{className:"/"===c.pathname?"selected":"",onClick:function(){t.replace("/")},children:[Object(C.jsx)("div",{className:"icon",children:Object(C.jsx)("div",{className:"icon-classes",slot:"start"})}),Object(C.jsx)(i.q,{children:e})]})})})]})};function I(){var e;return"has-header "+(null===(e=Object(i.K)())||void 0===e?void 0:e.get("mode"))}var T=function(){var e,t,n=Object(i.L)(),c=Object(b.a)(n,1)[0],r=(Object(u.d)(),Object(u.e)()),o=w((function(e){return e.nonPersistent})).headerTitle,a=w((function(e){return e.userStorage})).info,l=k((function(e){return e.userStorage})).logout,j=Object(s.useRef)(document.querySelector("ion-header")),O=function(){l(),window.open("/login","_SELF")},p=Object(s.useCallback)(Object(f.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(null===a||void 0===a?void 0:a.first_name)+" "+(null===a||void 0===a?void 0:a.last_name),c({header:t,buttons:[{icon:h.j,text:"Logout",handler:O}]});case 2:case"end":return e.stop()}}),e)}))),[a]);return Object(s.useEffect)((function(){j.current&&("/login"===r.pathname?j.current.style.display="none":j.current.style.display="initial")}),[r]),Object(C.jsxs)(C.Fragment,{children:[r.pathname.indexOf("class")<0?Object(C.jsx)(N,{}):Object(C.jsx)(S,{}),Object(C.jsx)(i.l,{id:"main-header",ref:j,children:Object(C.jsxs)(i.C,{children:[Object(C.jsx)(i.d,{slot:"start",children:Object(C.jsx)(i.t,{autoHide:!1})}),Object(C.jsx)(i.B,{children:o}),Object(C.jsxs)(i.d,{slot:"end",children:[Object(C.jsx)(i.b,{slot:"end",style:{height:30,width:30},children:(null===a||void 0===a||null===(e=a.preferences)||void 0===e?void 0:e.profile_picture)?Object(C.jsx)("img",{src:null===a||void 0===a||null===(t=a.preferences)||void 0===t?void 0:t.profile_picture,alt:"Lisa"}):Object(C.jsx)(i.m,{src:h.m,style:{width:"100%",height:"100%",background:"#fff"}})}),Object(C.jsx)(i.c,{onClick:p,children:Object(C.jsx)(i.m,{slot:"end",icon:h.c})})]})]})})]})},E=function(){var e=k((function(e){return e.nonPersistent})).setHeaderTitle,t=k((function(e){return e.classes})).setCurrentClass,n=Object(u.e)().state;return Object(i.P)((function(){n&&(t(n),e(n.name))})),Object(C.jsx)(i.u,{className:I(),children:Object(C.jsxs)(i.k,{children:[Object(C.jsx)("br",{}),Object(C.jsx)(i.A,{children:"Class Page"})]})})},A=n(60),L=function(e){var t=e.name,n=e.description,s=e.time_from,c=e.bg_image,r=e.time_to,o=e.date_from,a=e.teacher,l=Object(u.d)();return Object(C.jsxs)(i.e,{className:"class",onClick:function(){l.push({pathname:"/class",state:e})},children:[Object(C.jsxs)(i.g,{style:{backgroundImage:'linear-gradient(rgba(0, 0, 0, 0.26), rgba(0, 0, 0, 0)),url("'.concat(c||"/class/default.svg",'")')},children:[Object(C.jsx)(i.i,{children:t}),Object(C.jsx)(i.h,{children:n})]}),Object(C.jsxs)(i.f,{children:[Object(C.jsxs)("div",{className:"class-details",children:[Object(C.jsxs)(i.A,{children:[s," - ",r]}),Object(C.jsx)("br",{}),Object(C.jsx)(i.A,{children:o})]}),Object(C.jsx)(i.b,{children:(null===a||void 0===a?void 0:a.profile_picture)?Object(C.jsx)("img",{src:"".concat(null===a||void 0===a?void 0:a.profile_picture)}):Object(C.jsx)(i.m,{src:h.m,style:{width:"100%",height:"100%",background:"#fff"}})}),Object(C.jsx)("div",{className:"class-teacher",children:Object(C.jsx)(i.A,{children:(null===a||void 0===a?void 0:a.first_name)+" "+(null===a||void 0===a?void 0:a.last_name)})})]})]})},P=(n(112),function(){var e=Object(i.M)(),t=Object(b.a)(e,1)[0],n=Object(u.d)(),c=function(){var e=w((function(e){return e.userStorage})).isLoggedIn,t=Object(s.useState)(e),n=Object(b.a)(t,2),c=(n[0],n[1]);return Object(s.useEffect)((function(){c(e)}),[e]),e}(),r=k((function(e){return e.nonPersistent})).setHeaderTitle,o=k((function(e){return e.classes})).getClasses,a=k((function(e){return e.userStorage})).verifyToken,l=w((function(e){return e.userStorage})),j=l.accessToken,d=l.tokenType,f=Object(s.useState)(),O=Object(b.a)(f,2),p=O[0],m=O[1],v=Object(s.useRef)(),x=function(e,t,n){var c=function(e){e.style.pointerEvents="none",n&&n.forEach((function(t){e.querySelectorAll(t).forEach((function(e){e.style.display="none"}))})),t&&t.forEach((function(t){e.querySelectorAll(t).forEach((function(e){var t=e;if(null===e.querySelector(".skeleton-loader")){var n=document.createElement("div");n.classList.add("skeleton-loader"),e.prepend(n),"absolute"!==getComputedStyle(t).position&&(t.style.position="relative",t.style.overflow="hidden!important",t.style.background="none")}}))}))};return Object(s.useEffect)((function(){e.current&&c(e.current)}),[]),function(){e.current&&c(e.current)}}(v,["ion-card-header",".class-details ion-text",".class-teacher ion-text","ion-avatar"],["ion-card-title","ion-card-subtitle","ion-avatar ion-icon"]);return Object(i.P)((function(){r("Classes")}),[]),Object(s.useEffect)((function(){c?j&&d&&a({authData:{token:j,type:d},success:function(){o({success:function(e){m(e)},fail:function(e){var n,s;200!==(null===(n=e.response)||void 0===n?void 0:n.status)&&t("Cannot fetch classes [".concat(null===(s=e.response)||void 0===s?void 0:s.status,"]"))}})},fail:function(){n.replace("/login")}}):n.replace("/login")}),[c]),Object(C.jsx)(i.u,{className:I(),children:Object(C.jsxs)(i.k,{fullscreen:!0,children:[Object(C.jsx)(i.v,{onIonRefresh:function(e){m(null),x(),o({success:function(t){m(t),e.detail.complete()},fail:function(e){var n,s;200!==(null===(n=e.response)||void 0===n?void 0:n.status)&&t("Cannot fetch classes [".concat(null===(s=e.response)||void 0===s?void 0:s.status,"]"))}})},slot:"fixed",children:Object(C.jsx)(i.w,{})}),Object(C.jsxs)("div",{className:"classes",children:[Object(C.jsx)(i.p,{className:"iskwela-theme",children:Object(C.jsx)(i.o,{clearOnEdit:!1,placeholder:"Search",children:Object(C.jsx)(i.c,{slot:"end",onClick:function(){t("Search")},children:Object(C.jsx)(i.m,{icon:h.p})})})}),!p&&Object(C.jsx)("div",{ref:v,style:{width:"100%"},className:"classes",children:new Array(5).fill(0).map((function(e,t){return Object(C.jsx)(L,{name:"",description:"",time_from:"9:00 AM",time_to:"10:00 AM",date_from:"2 September 2021",date_to:"2 September 2021",bg_image:null},t)}))}),p&&p.classes.map((function(e){return Object(C.jsx)(L,Object(A.a)({},e),e.id)}))]})]})})}),D=(n(113),function(){var e=Object(u.d)(),t=Object(i.O)(),n=Object(b.a)(t,1)[0],c=Object(i.N)(),r=Object(b.a)(c,2),o=r[0],a=r[1],l=Object(s.useRef)(document.createElement("ion-input")),j=Object(s.useRef)(document.createElement("ion-input")),h=k((function(e){return e.userStorage})),O=(h.setAccessToken,h.login),p=function(){var t=Object(f.a)(d.a.mark((function t(){var s,c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=l.current.value+"",c=j.current.value+"",o(),O({username:s,password:c,success:function(){e.push("/"),a()},fail:function(e){e.response&&(401===e.response.status?n("Invalid Username/Password",2e3):n("Something went wrong. Please try again."),a())}});case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(C.jsx)(i.u,{id:"login",children:Object(C.jsxs)("div",{className:"login-wrapper",children:[Object(C.jsx)("img",{src:"/assets/icon/logo-single.svg",width:"80"}),Object(C.jsx)("h1",{children:"Sign in to iSkwela"}),Object(C.jsxs)(i.p,{className:"iskwela-theme",children:[Object(C.jsx)(i.q,{position:"floating",children:"Username"}),Object(C.jsx)(i.o,{clearOnEdit:!1,ref:l})]}),Object(C.jsxs)(i.p,{className:"iskwela-theme",children:[Object(C.jsx)(i.q,{position:"floating",children:"Password"}),Object(C.jsx)(i.o,{type:"password",clearOnEdit:!1,ref:j})]}),Object(C.jsx)("br",{}),Object(C.jsx)("br",{}),Object(C.jsx)("br",{}),Object(C.jsx)(i.c,{color:"secondary",class:"full",onClick:function(){p()},children:"Sign In"})]})})}),F=(n(114),function(){return Object(C.jsx)(i.a,{children:Object(C.jsx)(l.a,{store:_,children:Object(C.jsxs)(a.a,{children:[Object(C.jsx)(T,{}),Object(C.jsxs)(i.y,{id:"router-outlet",children:[Object(C.jsx)(u.a,{exact:!0,path:"/",component:P}),Object(C.jsx)(u.a,{exact:!0,path:"/login",component:D}),Object(C.jsx)(u.a,{exact:!0,path:"/class/:id?",component:E})]})]})})})});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var R=function(e){e&&e instanceof Function&&n.e(58).then(n.bind(null,177)).then((function(t){var n=t.getCLS,s=t.getFID,c=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),s(e),c(e),r(e),o(e)}))};o.a.render(Object(C.jsx)(c.a.StrictMode,{children:Object(C.jsx)(F,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),R()},56:function(e,t,n){},70:function(e,t,n){var s={"./ion-action-sheet.entry.js":[117,5],"./ion-alert.entry.js":[118,6],"./ion-app_8.entry.js":[119,7],"./ion-avatar_3.entry.js":[120,17],"./ion-back-button.entry.js":[121,18],"./ion-backdrop.entry.js":[122,43],"./ion-button_2.entry.js":[123,19],"./ion-card_5.entry.js":[124,20],"./ion-checkbox.entry.js":[125,21],"./ion-chip.entry.js":[126,22],"./ion-col_3.entry.js":[127,44],"./ion-datetime_3.entry.js":[128,10],"./ion-fab_3.entry.js":[129,23],"./ion-img.entry.js":[130,45],"./ion-infinite-scroll_2.entry.js":[131,46],"./ion-input.entry.js":[132,24],"./ion-item-option_3.entry.js":[133,25],"./ion-item_8.entry.js":[134,26],"./ion-loading.entry.js":[135,27],"./ion-menu_3.entry.js":[136,28],"./ion-modal.entry.js":[137,8],"./ion-nav_2.entry.js":[138,14],"./ion-popover.entry.js":[139,9],"./ion-progress-bar.entry.js":[140,29],"./ion-radio_2.entry.js":[141,30],"./ion-range.entry.js":[142,31],"./ion-refresher_2.entry.js":[143,11],"./ion-reorder_2.entry.js":[144,16],"./ion-ripple-effect.entry.js":[145,47],"./ion-route_4.entry.js":[146,32],"./ion-searchbar.entry.js":[147,33],"./ion-segment_2.entry.js":[148,34],"./ion-select_3.entry.js":[149,35],"./ion-slide_2.entry.js":[150,48],"./ion-spinner.entry.js":[151,13],"./ion-split-pane.entry.js":[152,49],"./ion-tab-bar_2.entry.js":[153,36],"./ion-tab_2.entry.js":[154,15],"./ion-text.entry.js":[155,37],"./ion-textarea.entry.js":[156,38],"./ion-toast.entry.js":[157,39],"./ion-toggle.entry.js":[158,12],"./ion-virtual-scroll.entry.js":[159,50]};function c(e){if(!n.o(s,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=s[e],c=t[0];return n.e(t[1]).then((function(){return n(c)}))}c.keys=function(){return Object.keys(s)},c.id=70,e.exports=c},72:function(e,t,n){var s={"./ion-icon.entry.js":[160,57]};function c(e){if(!n.o(s,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=s[e],c=t[0];return n.e(t[1]).then((function(){return n(c)}))}c.keys=function(){return Object.keys(s)},c.id=72,e.exports=c},91:function(e,t,n){}},[[115,3,4]]]);
//# sourceMappingURL=main.f74bd79b.chunk.js.map